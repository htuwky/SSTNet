è¿™æ˜¯ä¸€ä¸ªä¸ºæ‚¨é‡èº«å®šåˆ¶çš„å…¨æ–° `README.md` æ–‡æ¡£ï¼Œå®Œç¾åŒ¹é…æ‚¨ç°åœ¨çš„ **SSTNet v3.5 (Semantic-Aware & Adaptive Fusion)** æ¶æ„ã€‚

æˆ‘å·²ç»æ›´æ–°äº†**æ ¸å¿ƒæ¶æ„æè¿°**ï¼ˆåŠ å…¥äº†è¯­ä¹‰å›¾æµå’Œæµæ³¨æ„åŠ›ï¼‰ã€**æ•°æ®æµæ°´çº¿**ä»¥åŠ**å„ä¸ªè„šæœ¬çš„æœ€æ–°åŠŸèƒ½**ã€‚æ‚¨å¯ä»¥ç›´æ¥è¦†ç›–é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ `README.md`ã€‚

````markdown
# SSTNet v3.5: Semantic-Aware Spatio-Temporal Network

**SSTNet** æ˜¯ä¸€ä¸ªä¸“ä¸ºçœ¼åŠ¨è¿½è¸ªæ•°æ®ï¼ˆEye-Tracking Dataï¼‰è®¾è®¡çš„æ·±åº¦å­¦ä¹ å¤šæ¨¡æ€åˆ†ç±»æ¡†æ¶ã€‚

æœ¬é¡¹ç›®æ—¨åœ¨é€šè¿‡æ·±åº¦èåˆå—è¯•è€…çš„**æ³¨è§†è¡Œä¸ºï¼ˆæ—¶åºä¸ç”Ÿç†ç‰¹å¾ï¼‰**ã€**æ³¨è§†å†…å®¹ï¼ˆè§†è§‰ä¸ç©ºé—´ç‰¹å¾ï¼‰**ä»¥åŠ**æ½œåœ¨çš„è¯­ä¹‰å…³è”ï¼ˆç»“æ„ç‰¹å¾ï¼‰**ï¼Œè¾…åŠ©è¯Šæ–­ç²¾ç¥ç–¾ç—…ï¼ˆä¾‹å¦‚ï¼ŒåŒºåˆ†ç²¾ç¥åˆ†è£‚ç—‡æ‚£è€… SZ ä¸å¥åº·å¯¹ç…§ç»„ HCï¼‰ã€‚

v3.5 ç‰ˆæœ¬å¼•å…¥äº† **"è¯­ä¹‰åŠ¨æ€å›¾ (Semantic Dynamic Graph)"** å’Œ **"æµæ³¨æ„åŠ›æœºåˆ¶ (Stream-wise Attention)"**ï¼Œæ˜¾è‘—å¢å¼ºäº†æ¨¡å‹å¯¹å°æ ·æœ¬æ•°æ®çš„é€‚åº”èƒ½åŠ›å’Œå¯¹è·¨æ—¶ç©ºè¯­ä¹‰å›è§†è¡Œä¸ºçš„æ•æ‰èƒ½åŠ›ã€‚

---

## ğŸ§  æ ¸å¿ƒæ¶æ„ (Core Architecture)

SSTNet v3.5 é‡‡ç”¨ **ä¸‰æµå¤šæ¨¡æ€æ¶æ„ (Tri-Stream Multimodal Architecture)**ï¼Œé€šè¿‡è‡ªé€‚åº”æ³¨æ„åŠ›é—¨æ§è¿›è¡Œèåˆï¼š

### 1. æ—¶åºæµ (Temporal Stream: The "How")
- **æ ¸å¿ƒç»„ä»¶**: **Fourier Embedding + Transformer Encoder**
- **è¾“å…¥**: å±€éƒ¨è§†è§‰ç‰¹å¾ + ç”Ÿç†åæ ‡ (X, Y, dX, dY) + å…¨å±€ä¸Šä¸‹æ–‡
- **åŠŸèƒ½**: åˆ©ç”¨å‚…é‡Œå¶ä½ç½®ç¼–ç å°†ä½ç»´åæ ‡æ˜ å°„åˆ°é«˜ç»´ç©ºé—´ï¼Œé€šè¿‡ Self-Attention æ•æ‰æ³¨è§†è¡Œä¸ºçš„æ—¶åºé€»è¾‘ï¼ˆå¦‚ï¼šè¿Ÿç–‘ã€è·³è·ƒã€å‡è§†æ—¶é•¿ï¼‰ã€‚
- **ç‰¹ç‚¹**: è´Ÿè´£å¤„ç† "ç‰©ç†ä½ç½®" å’Œ "æ—¶é—´é¡ºåº"ã€‚

### 2. ç©ºé—´æµ (Spatial Stream: The "What")
- **æ ¸å¿ƒç»„ä»¶**: **NetVLAD (Vector of Locally Aggregated Descriptors)**
- **è¾“å…¥**: å±€éƒ¨è§†è§‰ç‰¹å¾ (CLIP Local Features)
- **åŠŸèƒ½**: å¿½ç•¥æ—¶é—´é¡ºåºï¼Œç»Ÿè®¡å—è¯•è€…å…³æ³¨äº†å¤šå°‘æ¬¡ç‰¹å®šç±»å‹çš„è§†è§‰åŒºåŸŸï¼ˆèšç±»ä¸­å¿ƒï¼‰ã€‚
- **ç‰¹ç‚¹**: è´Ÿè´£å¤„ç† "å…¨å±€å†…å®¹ç»Ÿè®¡"ï¼ˆä¾‹å¦‚ï¼šçœ‹äº†å¤šå°‘æ¬¡äººè„¸åŒºåŸŸ vs èƒŒæ™¯åŒºåŸŸï¼‰ã€‚

### 3. [æ ¸å¿ƒå‡çº§] ç»“æ„æµ (Structural Stream: The "Why")
- **æ ¸å¿ƒç»„ä»¶**: **Semantic Dynamic GNN (EdgeConv)**
- **è¾“å…¥**: çº¯è§†è§‰è¯­ä¹‰ç‰¹å¾ (CLIP Features)
- **æœºåˆ¶**: **ä¸å†åŸºäºç‰©ç†åæ ‡å»ºå›¾**ï¼Œè€Œæ˜¯åŸºäº **è§†è§‰å†…å®¹ç›¸ä¼¼åº¦** åŠ¨æ€æ„å»º K-è¿‘é‚»å›¾ (KNN)ã€‚
- **åŠŸèƒ½**: æ•æ‰è·¨è¶Šæ—¶ç©ºçš„ **"è¯­ä¹‰å›è§†" (Semantic Re-visiting)**ã€‚å³ä½¿ä¸¤ä¸ªæ³¨è§†ç‚¹ç‰©ç†è·ç¦»å¾ˆè¿œï¼Œåªè¦å®ƒä»¬éƒ½åœ¨çœ‹ç›¸ä¼¼ç‰©ä½“ï¼ˆå¦‚éƒ½åœ¨çœ‹çœ¼ç›ï¼‰ï¼Œä¹Ÿä¼šè¢«è¿æ¥å¹¶èšåˆç‰¹å¾ã€‚

### 4. [æ ¸å¿ƒå‡çº§] è‡ªé€‚åº”èåˆ (Adaptive Fusion)
- **ç»„ä»¶**: **Stream-wise Attention (è½»é‡çº§æµæ³¨æ„åŠ›)**
- **æœºåˆ¶**: åŠ¨æ€å­¦ä¹ ä¸‰ä¸ªæµçš„æƒé‡ $(w_1, w_2, w_3)$ã€‚
- **ä¼˜åŠ¿**: å®ç° "åƒäººåƒé¢" çš„è¯Šæ–­é€»è¾‘ã€‚å¯¹äºæŸäº›ç—…äººï¼Œæ¨¡å‹å¯èƒ½æ›´çœ‹é‡æ—¶åºå¼‚å¸¸ï¼›å¯¹äºå¦ä¸€äº›ï¼Œåˆ™æ›´çœ‹é‡è¯­ä¹‰ç»“æ„å¼‚å¸¸ã€‚

---

## ğŸ› ï¸ ç¯å¢ƒå‡†å¤‡ (Installation)

### ä¾èµ–å®‰è£…
è¯·ç¡®ä¿ Python >= 3.8ï¼Œå¹¶é…ç½®å¥½ CUDA ç¯å¢ƒã€‚

```bash
# 1. å®‰è£…é¡¹ç›®ä¾èµ–
pip install -r requirements.txt

# 2. ç¡®ä¿ CLIP å·²æ­£ç¡®å®‰è£…
pip install git+[https://github.com/openai/CLIP.git](https://github.com/openai/CLIP.git)

# 3. è¿è¡Œç¯å¢ƒè‡ªæ£€ (å¼ºçƒˆæ¨è)
python check_env.py
````

-----

## ğŸš€ å®Œæ•´æ•°æ®æµæ°´çº¿ (Data Pipeline)

ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼Œå³å¯å®Œæˆä»åŸå§‹ Excel åˆ°æœ€ç»ˆè¯Šæ–­çš„å…¨è¿‡ç¨‹ã€‚æ‰€æœ‰è·¯å¾„å‡åœ¨ `config.py` ä¸­é›†ä¸­é…ç½®ã€‚

### 0\. æ•°æ®å‡†å¤‡

å°†æ•°æ®æ”¾å…¥ `dataset/` ç›®å½•ï¼š

  - `dataset/Images/`: åŸå§‹å›¾ç‰‡åº“
  - `dataset/Train_Valid/Fixations/`: è®­ç»ƒé›† Excel æ–‡ä»¶
  - `dataset/Test/Fixations/`: æµ‹è¯•é›† Excel æ–‡ä»¶
  - `dataset/Train_Valid.xlsx`: å®˜æ–¹åˆ’åˆ†è¡¨ (ç”¨äº K-Fold)

### Step 1: æ•°æ®æ¸…æ´—ä¸åºåˆ—åŒ–

å°†åŸå§‹ Excel æ¸…æ´—ã€å»å™ªã€å½’ä¸€åŒ–ï¼Œå¹¶æ‹†åˆ†ä¸ºç‹¬ç«‹çš„ `.txt` åºåˆ—æ–‡ä»¶ã€‚

```bash
# å¤„ç†è®­ç»ƒ/éªŒè¯é›†
python data_process/split_fix.py --train

# å¤„ç†æµ‹è¯•é›†
python data_process/split_fix.py --test
```

### Step 2: æ¨¡æ‹Ÿè§†è§‰ (CLIP Feature Extraction)

æ¨¡æ‹Ÿäººçœ¼è§‚å¯Ÿï¼Œæ ¹æ®æ³¨è§†ç‚¹åæ ‡è£å‰ªå±€éƒ¨ Patchï¼Œæå– CLIP é«˜ç»´è¯­ä¹‰ç‰¹å¾ã€‚
*(æ­¤æ­¥éª¤ç”Ÿæˆ .npy æ–‡ä»¶è¾ƒå¤§ï¼Œéœ€ GPU åŠ é€Ÿ)*

```bash
# æå–è®­ç»ƒé›†ç‰¹å¾
python data_process/generate_clip_features.py --train

# æå–æµ‹è¯•é›†ç‰¹å¾
python data_process/generate_clip_features.py --test
```

### Step 3: è®­ç»ƒ SSTNet (Sequence Level)

è¿›è¡Œ 4-Fold äº¤å‰éªŒè¯è®­ç»ƒã€‚åŒ…å«å¯¹æ¯”å­¦ä¹  (SupCon)ã€Mixup æ•°æ®å¢å¼ºå’Œæ ‡ç­¾å¹³æ»‘ã€‚

```bash
# è®­ç»ƒç¬¬ 0 æŠ˜
python train.py --fold 0

# ä¾æ¬¡è®­ç»ƒå…¶ä»–æŠ˜
python train.py --fold 1
python train.py --fold 2
python train.py --fold 3
```

### Step 4: æå–é«˜é˜¶ç‰¹å¾ (For MIL)

ä½¿ç”¨è®­ç»ƒå¥½çš„ SSTNet ä½œä¸ºç‰¹å¾æå–å™¨ï¼Œä¸ºä¸‹ä¸€é˜¶æ®µçš„ MIL å‡†å¤‡æ•°æ®ã€‚

```bash
# æå–ç¬¬ 0 æŠ˜çš„ç‰¹å¾ Bag
python data_process/extract_features_hook.py --fold 0
# ... (å¯¹å…¶ä»–æŠ˜é‡å¤æ­¤æ­¥éª¤)
```

### Step 5: ç—…äººçº§è¯Šæ–­ (MIL Training)

è®­ç»ƒ Robust Gated Attention æ¨¡å‹ï¼Œèšåˆç—…äººçš„æ‰€æœ‰åºåˆ—ç‰¹å¾ï¼Œè¾“å‡ºæœ€ç»ˆè¯Šæ–­ã€‚

```bash
# è®­ç»ƒç¬¬ 0 æŠ˜çš„ MIL æ¨¡å‹
python train_mil.py --fold 0 --lr 1e-4 --dropout 0.5
```

-----

## âš™ï¸ å…³é”®é…ç½® (Configuration)

æ‰€æœ‰å‚æ•°å‡åœ¨ `config.py` ä¸­å®šä¹‰ã€‚

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
| :--- | :--- | :--- |
| `INPUT_DIM` | 512 | CLIP åŸå§‹ç‰¹å¾ç»´åº¦ |
| `HIDDEN_DIM`| 128 | **æ ¸å¿ƒç“¶é¢ˆå±‚**ï¼ŒSSTNet å†…éƒ¨è®¡ç®—ç»´åº¦ |
| `PHYSIO_DIM`| 4 | ç”Ÿç†ç‰¹å¾ (X, Y, dX, dY) |
| `GNN_K` | 4 | ç»“æ„æµ KNN é‚»å±…æ•°é‡ |
| `BATCH_SIZE`| 64 | è®­ç»ƒæ‰¹æ¬¡å¤§å° |
| `EPOCHS` | 100 | è®­ç»ƒè½®æ•° |

-----

## ğŸ“Š è¯„ä¼°å·¥å…·

é¡¹ç›®æä¾›äº†ä¸°å¯Œçš„å·¥ä¸šçº§è¯„ä¼°è„šæœ¬ï¼š

  - `test.py`: æ ‡å‡†æµ‹è¯•é›†æ¨ç†ï¼Œç”Ÿæˆ CSV æŠ¥å‘Šã€‚
  - `test_ems.py`: EMS ç‰¹å®šæ•°æ®é›†æ¨ç†ã€‚
  - `utils/industrial_eval_cv.py`: åŸºäºäº¤å‰éªŒè¯ç»“æœï¼Œè¿›è¡Œé˜ˆå€¼æ‰«æå’Œç°åŒºåˆ†æ (Gray Zone Analysis)ã€‚
  - `utils/industrial_eval_mil.py`: é’ˆå¯¹ MIL æ¨¡å‹çš„ç—…äººçº§è¯Šæ–­è¯„ä¼°ã€‚

-----

## ğŸ“ ç‰ˆæœ¬æ—¥å¿—

  - **v3.5 (Current)**:
      - ç»“æ„æµå‡çº§ä¸º **è¯­ä¹‰åŠ¨æ€å›¾ (Semantic KNN)**ã€‚
      - èåˆæ¨¡å—å‡çº§ä¸º **æµæ³¨æ„åŠ› (Stream-wise Attention)**ã€‚
      - ä¿®å¤äº†ç”Ÿç†ç‰¹å¾ç»´åº¦åŒ¹é… Bugã€‚
  - **v2.0**: å¼•å…¥ CLIP åŒæµç‰¹å¾ (Global Aware)ã€‚
  - **v1.0**: åŸºç¡€ Transformer + NetVLAD æ¶æ„ã€‚

<!-- end list -->

```
```